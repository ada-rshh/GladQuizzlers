<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="{{ url_for('static', filename='style(junwen).css') }}" rel="stylesheet">
    <link href="{{ url_for('static', filename='commentB4login.css') }}" rel="stylesheet">

    <title>Comment</title>

    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script src="./static/script.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <link rel="shortcut icon" href="./favicon.svg" type="image/svg+xml">
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Roboto:wght@300;400;500;700&family=Oswald:wght@600&display=swap"
        rel="stylesheet">
</head>

<body>

  <!--
    - #HEADER
  -->

  <header class="header" data-header>
    <div class="head-container">

      <h1>
        <a href="/" class="logo">Wildvine</a>
      </h1>

      <select name="language" class="lang-switch">

        <option value="english">English</option>
        <option value="french">French</option>
        <option value="spanish">Spanish</option>

      </select>

      <button class="nav-open-btn" aria-label="Open Menu" data-nav-open-btn>
        <ion-icon name="menu-outline"></ion-icon>
      </button>

      <nav class="navbar" data-navbar>

        <button class="nav-close-btn" aria-label="Close Menu" data-nav-close-btn>
          <ion-icon name="close-outline"></ion-icon>
        </button>

        <a href="/" class="logo">Wildvine</a>

        <ul class="navbar-list">

          <li>
            <a href="/" class="navbar-link" data-nav-link>
              <span>Home</span>

              <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>
            </a>
          </li>

          <li>
            <a href="#about" class="navbar-link" data-nav-link>
              <span>About</span>

              <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>
            </a>
          </li>

          <li>
            <a href="#service" class="navbar-link" data-nav-link>
              <span>Service</span>

              <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>
            </a>
          </li>

            <li>
            <a href="#" class="navbar-link" data-nav-link>
              <span>Donate</span>

              <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>
            </a>
          </li>

          <li>
            <a href="/shareB4login" class="navbar-link" data-nav-link>
              <span>Comment</span>

              <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>
            </a>
          </li>


          <li>
            <a href="/contactb4login" class="navbar-link" data-nav-link>
              <span>Contact</span>

              <ion-icon name="chevron-forward-outline" aria-hidden="true"></ion-icon>
            </a>
          </li>

        </ul>

      </nav>
      <form>
    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
  </form>



    </div>
  </header>


 <h1>Share your Ideas</h1>

    <div id="commentsContainer">
        <ul id="commentsList"></ul>
    </div>

    <form id="addCommentForm">

    </form>


<script>
    // Fetch and display comments
    async function fetchComments() {
        const response = await axios.get('/comments');
        const comments = response.data;
        commentsList.innerHTML = '';

        comments.forEach(comment => {
            const listItem = document.createElement('li');
            const timestamp = comment.timestamp ? new Date(comment.timestamp).toLocaleString() : 'N/A';

            listItem.innerHTML = `
                <div class="comment-item">
                    <div class="comment-header">
                        <span class="timestamp">${timestamp}</span>
<!--                        <div class="buttons-container">-->
<!--                            <button class="edit-button hidden" onclick="editComment('${comment._id}', '${comment.text}')">Edit</button>-->
<!--                            <button class="delete-button hidden" onclick="deleteComment('${comment._id}')">Delete</button>-->
<!--                        </div>-->
                    </div>
                    <span class="comment-text">${comment.text}</span>
<!--                    <button class="reply-button" onclick="toggleReplyForm('${comment._id}')">Reply</button>-->
<!--                    <div class="reply-form hidden" id="replyForm_${comment._id}">-->
<!--                        <input type="text" placeholder="Enter your reply" class="reply-input" id="replyText_${comment._id}">-->
<!--                        <button onclick="addReply('${comment._id}')">Submit Reply</button>-->
<!--                    </div>-->
                    <div class="replies-dropdown">
                        <button class="replies-dropdown-button">Show Replies</button>
                        <ul class="replies-dropdown-list hidden">
                            ${comment.replies.map(reply => `<li>${reply.text}</li>`).join('')}
                        </ul>
                    </div>
                </div>
            `;

            commentsList.appendChild(listItem);
        });
    }


   // Event listener to toggle replies dropdown visibility
    document.addEventListener('DOMContentLoaded', () => {
        const repliesDropdownButtons = document.querySelectorAll('.replies-dropdown-button');

        repliesDropdownButtons.forEach(button => {
            button.addEventListener('click', () => {
                const repliesList = button.nextElementSibling;
                repliesList.classList.toggle('hidden');
            });
        });
    });

<!--    // Add event listener for the comment submission form-->
<!--    addCommentForm.addEventListener('submit', event => {-->
<!--        event.preventDefault();-->
<!--        const text = commentText.value;-->
<!--        if (text.trim() !== '') {-->
<!--            addComment(text);-->
<!--        }-->
<!--    });-->

<!--    // Function to toggle reply form visibility-->
<!--    function toggleReplyForm(commentId) {-->
<!--        const replyForm = document.getElementById(`replyForm_${commentId}`);-->
<!--        replyForm.classList.toggle('hidden');-->
<!--    }-->

<!--    function addReply(commentId) {-->
<!--    const replyText = document.getElementById('replyText_' + commentId).value;-->

<!--    axios.post('/comments/' + commentId + '/replies', {-->
<!--        text: replyText-->
<!--    }).then(() => {-->
<!--        fetchComments();-->
<!--    });-->
<!--}-->

<!--    // Function to add a comment-->
<!--    async function addComment(text) {-->
<!--        await axios.post('/comments', { text });-->
<!--        commentText.value = '';-->
<!--        fetchComments();-->
<!--    }-->

<!--    // Function to edit a comment-->
<!--    async function editComment(id, text) {-->
<!--        const newText = prompt('Edit comment:', text);-->
<!--        if (newText !== null) {-->
<!--            await axios.put(`/comments/${id}`, { text: newText });-->
<!--            fetchComments();-->
<!--        }-->
<!--    }-->

<!--    // Function to delete a comment-->
<!--    async function deleteComment(id) {-->
<!--        if (confirm('Are you sure you want to delete this comment?')) {-->
<!--            await axios.delete(`/comments/${id}`);-->
<!--            fetchComments();-->
<!--        }-->
<!--    }-->

    // Event listener to toggle replies dropdown visibility
    document.addEventListener('DOMContentLoaded', () => {
        const repliesDropdownButtons = document.querySelectorAll('.replies-dropdown-button');

        repliesDropdownButtons.forEach(button => {
            button.addEventListener('click', () => {
                const repliesList = button.nextElementSibling;
                repliesList.classList.toggle('hidden');
            });
        });
    });

    // Fetch and display comments when the page loads
    fetchComments();
</script>








  <!--
    - custom js link
  -->
  <script src="./static/script.js"></script>



  <!--
    - ionicon link
  -->
  <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
  <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

</body>

</html>